<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PokemonList</title>
    <script src="../../node_modules/jquery/dist/jquery.js"></script>
    <style>
        #pokeName{
            text-transform: capitalize;

        }
        table, td, tr {
            border: 1px solid black;
            text-align: center;
        }

        #listDiv{
            width: 50%;
            margin:0 auto;
        }
    </style>
</head>
<body>
    <div>
        <select id="typeSelect" onchange="queryByPokeType()">
            <option value="0">all pokemon type</option>
            <option value="10">fire</option>
            <option value="11">water</option>
            <option value="12">grass</option>
        </select>
    </div>

    <div id="listDiv">
        <table id="pokeTable">
            <thead>
                <td>Number</td>
                <td>Name</td>
                <td>Picture</td>
            </thead>
            <tbody id="tableBody">

            </tbody>
        </table>
    </div>

<script>

    $(document).ready(function () {
        $.get("http://pokeapi.co/api/v2/pokemon/?limit=20", function (data, status) {

            for (pokeId in data.results){

                var appendTag = "<tr>" +
                        "<td>" +
                        (++pokeId) +
                        "</td>" +
                        "<td id='pokeName'>" +
                            data.results[--pokeId].name +
                        "</td>" +
                        "<td>" +
                                "<img src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/" +
                        (++pokeId) + "\.png' >"
                        "</td>" +
                        "</tr>>";
                $("#pokeTable tbody").append(appendTag);

            }
        })
    })


    function queryByPokeType() {
        var  selectedType = document.getElementById("typeSelect").value;
        $("#tableBody").empty();

        $.get("http://pokeapi.co/api/v2/type/" + selectedType, function (data, status) {
            var regxPattern = "/\/\d+\//"; //    /\/[0-9*]\//
            var limit = 20;
            if (data.pokemon.length < 20) {limit = data.pokemon.length;}
             for (var i = 0; i < limit; i++){

                 var pokeId = regxPattern.match(data.pokemon[i].url);
                 if (pokeId != null){
                     pokeId = pokeId[0].split("/")[1];

                     var appendTag = "<tr>" +
                             "<td>" +
                             (pokeId) +
                             "</td>" +
                             "<td id='pokeName'>" +
                             data.pokemon[i].name +
                             "</td>" +
                             "<td>" +
                             "<img src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/" +
                             (pokeId) + "\.png' >"
                     "</td>" +
                     "</tr>>";

                     $("#pokeTable tbody").append(appendTag);
                 }



             }
        })
    }



</script>
</body>
</html>